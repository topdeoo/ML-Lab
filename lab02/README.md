# Lab 02 Perceptron And Neural Networks

## 实验环境

使用 `jupyter` 完成实验，具体而言，你只需要补全 `lab.ipynb` 中的代码即可

## 实验数据

使用了 `sklearn` 中的数据集，略去了处理数据的环节，这次使用的是鸢尾花数据集。

数据集含义的解释：

id：数据的编号（没什么实际用处）

sepal length (cm)：花萼长度

sepal width (cm)：花萼宽度

petal length (cm)：花瓣长度

petal width (cm)：花瓣宽度

class：鸢尾花的类别，0代表Setosa，1代表Versicolour，2代表Virginica

## 实验任务

> 注意，因为我们感知机学习算法只学习过二分类问题，所以我们用这两种方法来做二分类问题：
> 
> 1. 我们将Setosa鸢尾花视为正类，其他两种视为负类
> 
> 2. 我们只取 Setosa 与 Versicolour 两类花做分类，另外一种删去

实现一个名为 `Perceptron` 的类，这个类是一个感知机模型，通过 `fit` 方法来训练这个感知机模型，通过 `predict` 方法来给出预测结果。

我们需要使用`acc`来衡量模型的好坏，通过计算 $acc = \frac{\sum^n_{i=1}I(\hat{y}_i == y_i)}{n} * 100\%$，其中 $I(\hat{y}_i == y_i)$ 表示如果 $\hat{y}_i == y_i$就取 $1$，否则为 $0$。

## 进阶任务
如果已经自己学过了 `BP` 算法，那么实验任务为：

请写一个名为`NN`的类，这个类是一个神经网络，网络结构可以设计为如下形式：输入层有4个节点，对应鸢尾花的4个特征，一个隐含层，隐含层节点个数为1，输出层一个节点，输出层节点输出1时表示正类，输出0时表示负类.

网络的激活函数为`sigmoid`函数，各节点可以有阈值也可以没有，采用`BP`算法进行训练，并对训练后的网络进行性能测试。

具体而言，我们可以把这个网络写为$y = \sigma(b_2 + W_2^T\sigma(b_1 + W_1^Tx))$， 样本$x$的类别可以写为$class(x) = sign(y - 0.5)$，损失函数我们定义为 $Loss(W_1, W_2, b_1, b_2) = \frac{1}{2}\sum^n_{i=1}(y_i - \hat{y}_i)^2$，其中 $\hat{y}_i$ 为网络的预测值。

> 这个损失函数的定义是不对的，分类问题的损失函数不应该使用 MSE，但这里主要是为了让你理解BP算法的过程，这个求导比较好求一些
